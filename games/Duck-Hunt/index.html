<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mobile Duck Hunt</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom, #6a11cb, #fff);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            color: #333;
            overflow: hidden;
            touch-action: manipulation;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .header {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            padding: 15px;
            width: 100%;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.8rem;
        }
        
        p {
            margin-bottom: 10px;
            line-height: 1.4;
            color: #34495e;
            font-size: 0.9rem;
        }
        
        .game-container {
            position: relative;
            width: 100%;
            height: 50vh;
            min-height: 300px;
            overflow: hidden;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        #game-canvas {
            width: 100%;
            height: 100%;
            border-radius: 16px;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 0 5px;
        }
        
        .btn {
            padding: 12px 20px;
            border-radius: 50px;
            border: none;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            flex: 1;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:active {
            background: #2980b9;
            transform: scale(0.98);
        }
        
        .btn-secondary {
            background: #6a11cb;
            color: white;
        }
        
        .btn-secondary:active {
            background: #4e0ba5;
            transform: scale(0.98);
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            gap: 10px;
        }
        
        .stat-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            padding: 12px;
            flex: 1;
            text-align: center;
        }
        
        .stat-title {
            font-size: 0.8rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            padding: 20px;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            padding: 25px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .modal h2 {
            color: #3498db;
            margin-bottom: 15px;
            font-size: 1.6rem;
        }
        
        .modal p {
            margin-bottom: 20px;
        }
        
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            color: white;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mobile optimizations */
        @media (max-width: 480px) {
            .header {
                padding: 12px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .btn {
                min-width: 100px;
                padding: 10px 15px;
                font-size: 0.85rem;
            }
            
            .stat-card {
                padding: 10px;
            }
            
            .stat-title {
                font-size: 0.75rem;
            }
            
            .stat-value {
                font-size: 1.2rem;
            }
            
            .game-container {
                height: 45vh;
                min-height: 250px;
            }
        }
        
        /* Prevent text selection */
        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="container no-select">
        <div class="header">
            <h1>Duck Hunt</h1>
            <p>Shoot the ducks before they fly away! Tap to aim and shoot.</p>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-title">SCORE</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">TIME</div>
                <div class="stat-value" id="time">60</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">DUCKS</div>
                <div class="stat-value" id="ducks">0/10</div>
            </div>
        </div>
        
        <div class="game-container">
            <div id="game-canvas"></div>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" id="startBtn">Start Game</button>
            <button class="btn btn-secondary" id="instructionsBtn">How to Play</button>
        </div>
    </div>

    <div class="modal" id="instructionsModal">
        <div class="modal-content">
            <h2>How to Play</h2>
            <p>Tap on the screen to aim and shoot the ducks. Each duck hit adds to your score.</p>
            <p>The faster you hit them, the more points you get! Game lasts for 60 seconds.</p>
            <button class="btn btn-primary" id="closeInstructions">Got it!</button>
        </div>
    </div>

    <div class="modal" id="gameOverModal">
        <div class="modal-content">
            <h2>Game Over</h2>
            <p>Your final score: <span id="finalScore">0</span></p>
            <div class="controls" style="margin-top: 20px;">
                <button class="btn btn-primary" id="playAgainBtn">Play Again</button>
            </div>
        </div>
    </div>

    <div class="loader" id="loader">
        <div class="spinner"></div>
        <p>Loading game assets...</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Game elements
            const scoreElement = document.getElementById('score');
            const timeElement = document.getElementById('time');
            const ducksElement = document.getElementById('ducks');
            const startBtn = document.getElementById('startBtn');
            const instructionsBtn = document.getElementById('instructionsBtn');
            const instructionsModal = document.getElementById('instructionsModal');
            const closeInstructions = document.getElementById('closeInstructions');
            const gameOverModal = document.getElementById('gameOverModal');
            const finalScoreElement = document.getElementById('finalScore');
            const playAgainBtn = document.getElementById('playAgainBtn');
            const loader = document.getElementById('loader');

            // Game state
            let score = 0;
            let timeLeft = 60;
            let ducksHit = 0;
            let totalDucks = 10;
            let gameActive = false;
            
            // Calculate game dimensions based on container
            const gameContainer = document.querySelector('.game-container');
            const gameWidth = gameContainer.clientWidth;
            const gameHeight = gameContainer.clientHeight;
            
            // Phaser game configuration
            const config = {
                type: Phaser.AUTO,
                parent: 'game-canvas',
                width: gameWidth,
                height: gameHeight,
                backgroundColor: '#87CEEB',
                physics: {
                    default: 'arcade',
                    arcade: {
                        gravity: { y: 0 },
                        debug: false
                    }
                },
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                },
                input: {
                    activePointers: 3
                }
            };
            
            let game;
            let crosshair;
            let ducks;
            let lastFired = 0;
            let gameTimer;
            
            // Preload assets
            function preload() {
                // Create duck sprite using graphics
                const duckGraphics = this.add.graphics();
                duckGraphics.fillStyle(0xff9800);
                duckGraphics.fillEllipse(16, 16, 30, 20);
                duckGraphics.fillStyle(0xffc107);
                duckGraphics.fillEllipse(25, 8, 15, 12);
                duckGraphics.generateTexture('duck', 32, 32);
                duckGraphics.destroy();
                
                // Create crosshair
                const crosshairGraphics = this.add.graphics();
                crosshairGraphics.lineStyle(3, 0x3498db);
                crosshairGraphics.strokeCircle(16, 16, 15);
                crosshairGraphics.lineStyle(3, 0x3498db);
                crosshairGraphics.lineBetween(16, 0, 16, 10);
                crosshairGraphics.lineBetween(16, 22, 16, 32);
                crosshairGraphics.lineBetween(0, 16, 10, 16);
                crosshairGraphics.lineBetween(22, 16, 32, 16);
                crosshairGraphics.fillStyle(0x3498db);
                crosshairGraphics.fillCircle(16, 16, 3);
                crosshairGraphics.generateTexture('crosshair', 32, 32);
                crosshairGraphics.destroy();
                    
                // Create hit effect
                const hitGraphics = this.add.graphics();
                hitGraphics.fillStyle(0xe74c3c);
                hitGraphics.fillCircle(16, 16, 15);
                hitGraphics.generateTexture('hit', 32, 32);
                hitGraphics.destroy();
            }
            
            // Create game objects
            function create() {
                // Set up world bounds
                this.physics.world.setBounds(0, 0, config.width, config.height);
                
                // Create crosshair
                crosshair = this.add.sprite(0, 0, 'crosshair');
                crosshair.setDepth(1000);
                crosshair.setVisible(false);
                
                // Create ducks group
                ducks = this.physics.add.group();
                
                // Input handling
                this.input.on('pointermove', (pointer) => {
                    if (gameActive) {
                        crosshair.setVisible(true);
                        crosshair.x = pointer.x;
                        crosshair.y = pointer.y;
                    }
                });
                
                this.input.on('pointerdown', (pointer) => {
                    if (!gameActive) return;
                    
                    // Check for duck hits
                    ducks.getChildren().forEach(duck => {
                        const distance = Phaser.Math.Distance.Between(
                            pointer.x, pointer.y, 
                            duck.x, duck.y
                        );
                        
                        if (distance < 30) {
                            // Duck hit!
                            duck.setTexture('hit');
                            duck.hit = true;
                            
                            // Increase score based on speed
                            const points = Math.floor(10 + Math.abs(duck.body.velocity.x) / 2);
                            score += points;
                            scoreElement.textContent = score;
                            
                            ducksHit++;
                            ducksElement.textContent = `${ducksHit}/${totalDucks}`;
                            
                            // Remove duck after a short delay
                            this.time.delayedCall(300, () => {
                                if (duck.active) {
                                    duck.destroy();
                                    spawnDuck.call(this);
                                }
                            });
                        }
                    });
                    
                    // Fire rate limiting
                    if (this.time.now > lastFired) {
                        lastFired = this.time.now + 200;
                    }
                });
                
                // Hide crosshair when pointer leaves game area
                this.input.on('pointerout', () => {
                    crosshair.setVisible(false);
                });
                
                // Initially hide the game scene
                this.scene.setVisible(false);
                
                // Hide loader when game is ready
                loader.style.display = 'none';
            }
            
            // Spawn a new duck
            function spawnDuck() {
                if (ducks.getLength() >= 3 || !gameActive) return;
                
                const x = Phaser.Math.Between(0, 1) ? -30 : config.width + 30;
                const y = Phaser.Math.Between(50, config.height - 50);
                
                const duck = ducks.create(x, y, 'duck');
                duck.hit = false;
                
                // Set random velocity
                const vx = Phaser.Math.Between(150, 250) * (x > config.width/2 ? -1 : 1);
                const vy = Phaser.Math.Between(-80, 80);
                
                duck.setVelocity(vx, vy);
                duck.setAngularVelocity(Phaser.Math.Between(-20, 20));
                duck.setCollideWorldBounds(true);
                duck.setBounce(1, 1);
                
                // Remove duck when it goes off screen
                duck.checkWorldBounds = true;
                duck.outOfBoundsKill = true;
            }
            
            // Update game state
            function update() {
                if (!gameActive) return;
                
                // Randomly change direction of ducks
                ducks.getChildren().forEach(duck => {
                    if (!duck.hit && Phaser.Math.Between(0, 100) > 98) {
                        duck.setVelocityY(Phaser.Math.Between(-80, 80));
                    }
                });
            }
            
            // Start the game
            function startGame() {
                if (gameActive) return;
                
                // Reset game state
                score = 0;
                timeLeft = 60;
                ducksHit = 0;
                scoreElement.textContent = score;
                timeElement.textContent = timeLeft;
                ducksElement.textContent = `${ducksHit}/${totalDucks}`;
                gameActive = true;
                
                // Clear any existing ducks
                ducks.clear(true, true);
                
                // Show the game scene
                game.scene.scenes[0].scene.setVisible(true);
                
                // Spawn initial ducks
                for (let i = 0; i < 3; i++) {
                    spawnDuck.call(game.scene.scenes[0]);
                }
                
                // Start game timer
                clearInterval(gameTimer);
                gameTimer = setInterval(() => {
                    timeLeft--;
                    timeElement.textContent = timeLeft;
                    
                    if (timeLeft <= 0 || ducksHit >= totalDucks) {
                        endGame();
                    }
                }, 1000);
            }
            
            // End the game
            function endGame() {
                gameActive = false;
                clearInterval(gameTimer);
                
                // Show game over modal
                finalScoreElement.textContent = score;
                gameOverModal.classList.add('active');
            }
            
            // Initialize the game
            game = new Phaser.Game(config);
            
            // Event listeners
            startBtn.addEventListener('click', startGame);
            
            instructionsBtn.addEventListener('click', () => {
                instructionsModal.classList.add('active');
            });
            
            closeInstructions.addEventListener('click', () => {
                instructionsModal.classList.remove('active');
            });
            
            playAgainBtn.addEventListener('click', () => {
                gameOverModal.classList.remove('active');
                startGame();
            });
            
            // Handle window resize
            window.addEventListener('resize', function() {
                const newWidth = gameContainer.clientWidth;
                const newHeight = gameContainer.clientHeight;
                
                game.scale.resize(newWidth, newHeight);
                game.config.width = newWidth;
                game.config.height = newHeight;
                
                game.scene.scenes[0].physics.world.setBounds(0, 0, newWidth, newHeight);
            });
            
            // Hide loader after a short time (simulating asset loading)
            setTimeout(() => {
                loader.style.display = 'none';
            }, 1500);
        });
    </script>
</body>
</html>